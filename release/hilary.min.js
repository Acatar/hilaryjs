/*! hilary.js 2015-02-17 */
!function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l=[],m=[];g={containerRegistration:"hilary::container",parentContainerRegistration:"hilary::parent",singletons:"__singletons",notResolvable:"hilary::handler::not::resolvable",pipeline:{beforeRegister:"hilary::before::register",afterRegister:"hilary::after::register",beforeResolve:"hilary::before::resolve",afterResolve:"hilary::after::resolve",beforeNewChild:"hilary::before::new::child",afterNewChild:"hilary::after::new::child"}},h=function(){var a,b,c={},d=Object.prototype,e=d.toString,f=(d.hasOwnProperty,{}),g=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"];for(a=0;a<g.length;a++)b=g[a],f["[object "+b+"]"]=b.toLowerCase();return c.type=function(a){return"undefined"==typeof a?"undefined":null===a?String(a):"object"==typeof a||"function"==typeof a?f[e.call(a)]||"object":typeof a},c.notDefined=function(a){try{return"undefined"===this.type(a)}catch(b){return!0}},c.isDefined=function(a){try{return"undefined"!==this.type(a)}catch(b){return!1}},c.isFunction=function(a){return"function"===this.type(a)},c.notFunction=function(a){return"function"!==this.type(a)},c.isObject=function(a){return"object"===this.type(a)},c.notObject=function(a){return"object"!==this.type(a)},c.isArray=function(a){return"array"===this.type(a)},c.notArray=function(a){return"array"!==this.type(a)},c.isString=function(a){return"string"===this.type(a)},c.notString=function(a){return"string"!==this.type(a)},c.isBoolean=function(a){return"boolean"===this.type(a)},c.notBoolean=function(a){return"boolean"!==this.type(a)},c.notNullOrWhitespace=function(a){if(!a)return!1;if(this.notString(a))throw new Error("Unable to check if a non-string is whitespace.");return/([^\s])/.test(a)},c.isNullOrWhitespace=function(a){return this.notNullOrWhitespace(a)===!1},c},j=new h,i=function(a){var b=function(b,c,d){var e=a.isString(c)?c:b,f=new Error(e);return f.message=e,b!==e&&(f.name=b),d&&(f.data=d),f};this.makeException=b,this.argumentException=function(c,d,e){var f=a.notDefined(d)?c:c+" (argument: "+d+")";return b("ArgumentException",f,e)},this.dependencyException=function(c,d,e){var f=a.notDefined(d)?c:c+" (dependency: "+d+"). If the module exists, does it return a value?";return b("DependencyException",f,e)},this.notImplementedException=function(a,c){return b("NotImplementedException",a,c)},this.notResolvableException=function(a){return this.dependencyException("The module cannot be resolved",a)}},k=new i(j),e=function(){this.beforeRegisterEvents=[],this.afterRegisterEvents=[],this.beforeResolveEvents=[],this.afterResolveEvents=[],this.beforeNewChildEvents=[],this.afterNewChildEvents=[]},f=function(a,b){var c,d,f,h,i,j,l,m,n=new e;c=function(a,b){switch(a){case g.pipeline.beforeRegister:n.beforeRegisterEvents.push(b);break;case g.pipeline.afterRegister:n.afterRegisterEvents.push(b);break;case g.pipeline.beforeResolve:n.beforeResolveEvents.push(b);break;case g.pipeline.afterResolve:n.afterResolveEvents.push(b);break;case g.pipeline.beforeNewChild:n.beforeNewChildEvents.push(b);break;case g.pipeline.afterNewChild:n.afterNewChildEvents.push(b);break;default:throw k.notImplementedException("the pipeline event you are trying to register is not implemented (name: "+a+")")}},d=function(a,c){var d,e;for(d=0;d<a.length;d++)e=a[d],e.once&&a.splice(d,1),b.isFunction(e)&&e.apply(null,c)},f=function(b,c){d(this.events.beforeRegisterEvents,[a,b,c])},h=function(b,c){d(this.events.afterRegisterEvents,[a,b,c])},i=function(b){d(this.events.beforeResolveEvents,[a,b])},j=function(b,c){d(this.events.afterResolveEvents,[a,b,c])},l=function(b){d(this.events.beforeNewChildEvents,[a,b])},m=function(b,c){d(this.events.afterNewChildEvents,[a,b,c])},this.events=n,this.registerEvent=c,this.beforeRegister=f,this.afterRegister=h,this.beforeResolve=i,this.afterResolve=j,this.beforeNewChild=l,this.afterNewChild=m},d=function(a,b){if(this.dependencies=void 0,this.ctor=void 0,this.singleton=!1,j.isArray(a)&&(this.dependencies=a),j.isFunction(a))this.ctor=a;else if(j.isObject(a))this.ctor=function(){return a};else{if(!j.isFunction(b))throw k.argumentException("A constructor of type function is required","ctor (or dependencies)",name);this.ctor=b}j.isBoolean(this.ctor.singleton)&&(this.singleton=!0)},c=function(e){var j,k,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this,E=e||{},F={__singletons:{}},G=E.parentContainer,H=E.utils||new h,I=E.exceptions||new i(H),J=E.pipeline||new f(D,H);for(j=function(a){a=a||{};var b,d;return b={parentContainer:D,utils:a.utils||H,exceptions:a.exceptions||I,lessMagic:a.lessMagic||E.lessMagic},J.beforeNewChild(b),d=new c(b),J.afterNewChild(b,d),d},k=function(a,b){if(J.beforeRegister(a,b),H.notString(a))throw I.argumentException("The first argument must be the name of the module","moduleNameOrFunc",a);if(a===g.containerRegistration)throw I.argumentException("The name you are trying to register is reserved","moduleName",a);if(a===g.parentContainerRegistration)throw I.argumentException("The name you are trying to register is reserved","moduleName",a);if(a===g.singletons)throw I.argumentException("The name you are trying to register is reserved","moduleName",a);if(H.notDefined(b))throw I.argumentException("The second argument must be the module definition","moduleDefinition");return F[a]=b,J.afterRegister(a,b),D},o=function(a,b,c){if(H.isFunction(c))return k(a,new d(b,c));if(H.isString(a)&&H.isFunction(b))return k(a,new d(b));if(H.isArray(a)&&H.isFunction(b))return p(a,b);if(H.isFunction(a))return p(a);if(H.isObject(a))return p(function(b,c){var d;for(d in a)a.hasOwnProperty(d)&&(c[d]=a[d])});if(H.isString(a)&&H.isObject(b))return p(function(c,d){d[a]=b});throw I.argumentException("A factory function was not found to define "+a,"factory")},q=function(a){var b,c;if(H.isObject(a)&&(a.name||a.dependencies||a.factory))r(a);else if(H.isObject(a))for(b in a)a.hasOwnProperty(b)&&r(a[b]);else{if(!H.isArray(a))throw I.argumentException("A index must be defined and must be a typeof object or array","index");for(c=0;c<a.length;c+=1)r(a[c])}},r=function(a){a.name&&a.dependencies&&a.factory?D.register(a.name,a.dependencies,a.factory):a.name&&a.factory?D.register(a.name,a.factory):a.dependencies&&a.factory?D.resolve(a.dependencies,a.factory):a.factory&&D.register(a.factory)},t=function(a){var b;return a instanceof d&&a.singleton&&(b=F.__singletons[a.name])?b:a instanceof d?u(a):a},u=function(a){var b,c=[];if(H.isArray(a.dependencies)&&a.dependencies.length>0){for(b=0;b<a.dependencies.length;b++)c.push(n(a.dependencies[b]));return v(a,a.ctor.apply(null,c))}return 0===a.ctor.length?v(a,a.ctor.call()):a.ctor},v=function(a,b){return a.singleton&&(F.__singletons[a.name]=b),b},w=function(a){return a===g.containerRegistration?x():a===g.parentContainerRegistration?y():void 0},n=function(c){var d,e;if(J.beforeResolve(c),d=F[c],void 0!==d)return e=t(d),J.afterResolve(c,e),e;if(e=w(c),void 0!==e)return J.afterResolve(c,e),e;if(void 0!==G)return G.resolve(c);if(b?e=b(c):window&&(e=a[c]),void 0!==e)return J.afterResolve(c,e),e;if(!H.isFunction(F[g.notResolvable]))throw I.notResolvableException(c);F[g.notResolvable](c)},p=function(b,c){if("function"==typeof b)return b(n,x(),"undefined"!=typeof module?module:a);if("string"==typeof b)return n(b);var d,e=[];for(d=0;d<b.length;d++)e.push(n(b[d]));return c.apply(null,e)},s=function(a){var b,c;if(H.isString(a))delete F[a],delete F.__singletons[a];else if(H.isArray(a))for(c=0;c<a.length;c+=1)delete F[a[c]],delete F.__singletons[a[c]];else for(b in F)F.hasOwnProperty(b)&&delete F[b]},x=function(){return F},y=function(){return void 0!==G?G.getContainer():null},D.createChildContainer=j,D.getContainer=x,D.getParentContainer=y,D.register=E.lessMagic?k:o,D.autoRegister=q,D.resolve=E.lessMagic?n:p,D.amd={register:o,resolve:p},D.ioc={register:k,resolve:n},D.tryResolve=function(a){try{return D.resolve(a)}catch(b){console.log(b)}},D.dispose=s,D.registerEvent=function(a,b){return J.registerEvent(a,b)},D.getConstants=function(){return g},D.getUtils=function(){return H},D.getExceptionHandlers=function(){return I},z=0;z<l.length;z++)A=l[z],H.isFunction(A.factory)?D[A.name]=A.factory(D):H.isDefined(A.factory)&&(D[A.name]=A.factory);for(B=0;B<m.length;B++)C=m[B],H.isFunction(C)&&C(D,E)},c.extend=function(a,b){return l.push({name:a,factory:b}),!0},c.onInit=function(a){return m.push(a),!0},a.Hilary=c,a.HilaryModule=d}("undefined"!=typeof module&&module.exports?module.exports:window,"undefined"!=typeof module&&module.exports?require:void 0);