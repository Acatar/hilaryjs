/*! hilary.js 2015-02-20 */
!function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=[],A=[];g={containerRegistration:"hilary::container",parentContainerRegistration:"hilary::parent",singletons:"__singletons",notResolvable:"hilary::handler::not::resolvable",pipeline:{beforeRegister:"hilary::before::register",afterRegister:"hilary::after::register",beforeResolve:"hilary::before::resolve",afterResolve:"hilary::after::resolve",beforeNewChild:"hilary::before::new::child",afterNewChild:"hilary::after::new::child",onError:"hilary::error"}},h=function(){var a,b,c={},d=Object.prototype,e=d.toString,f=(d.hasOwnProperty,{}),g=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"];for(a=0;a<g.length;a+=1)b=g[a],f["[object "+b+"]"]=b.toLowerCase();return c.type=function(a){return"undefined"==typeof a?"undefined":null===a?String(a):"object"==typeof a||"function"==typeof a?f[e.call(a)]||"object":typeof a},c.notDefined=function(a){try{return"undefined"===this.type(a)}catch(b){return!0}},c.isDefined=function(a){try{return"undefined"!==this.type(a)}catch(b){return!1}},c.isFunction=function(a){return"function"===this.type(a)},c.notFunction=function(a){return"function"!==this.type(a)},c.isObject=function(a){return"object"===this.type(a)},c.notObject=function(a){return"object"!==this.type(a)},c.isArray=function(a){return"array"===this.type(a)},c.notArray=function(a){return"array"!==this.type(a)},c.isString=function(a){return"string"===this.type(a)},c.notString=function(a){return"string"!==this.type(a)},c.isBoolean=function(a){return"boolean"===this.type(a)},c.notBoolean=function(a){return"boolean"!==this.type(a)},c.notNullOrWhitespace=function(a){if(!a)return!1;if(this.notString(a))throw new Error("Unable to check if a non-string is whitespace.");return/([^\s])/.test(a)},c.isNullOrWhitespace=function(a){return this.notNullOrWhitespace(a)===!1},c.createGuid=function(){return"zxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},c},i=new h,j=function(a){var b,c={};return b=function(b,c,d){var e=a.isString(c)?c:b,f=new Error(e);return f.message=e,b!==e&&(f.name=b),d&&(f.data=d),f},c.makeException=b,c.argumentException=function(c,d,e){var f=a.notDefined(d)?c:c+" (argument: "+d+")";return b("ArgumentException",f,e)},c.dependencyException=function(c,d,e){var f=a.notDefined(d)?c:c+" (dependency: "+d+"). If the module exists, does it return a value?";return b("DependencyException",f,e)},c.notImplementedException=function(a,c){return b("NotImplementedException",a,c)},c.notResolvableException=function(a){return c.dependencyException("The module cannot be resolved",a)},c},k=new j(i),e=function(){var a={};return a.beforeRegisterEvents=[],a.afterRegisterEvents=[],a.beforeResolveEvents=[],a.afterResolveEvents=[],a.beforeNewChildEvents=[],a.afterNewChildEvents=[],a.onError=[],a},f=function(a,b){var c,d,f,h,i,j,l,m,n,o={},p=new e;return c=function(a,b){switch(a){case g.pipeline.beforeRegister:p.beforeRegisterEvents.push(b);break;case g.pipeline.afterRegister:p.afterRegisterEvents.push(b);break;case g.pipeline.beforeResolve:p.beforeResolveEvents.push(b);break;case g.pipeline.afterResolve:p.afterResolveEvents.push(b);break;case g.pipeline.beforeNewChild:p.beforeNewChildEvents.push(b);break;case g.pipeline.afterNewChild:p.afterNewChildEvents.push(b);break;case g.pipeline.onError:p.onError.push(b);break;default:throw k.notImplementedException("the pipeline event you are trying to register is not implemented (name: "+a+")")}},d=function(a,c){var d,e;for(d=0;d<a.length;d+=1)e=a[d],e.once&&a.splice(d,1),b.isFunction(e)&&e.apply(null,c)},f=function(b){d(o.events.beforeRegisterEvents,[a,b])},h=function(b){d(o.events.afterRegisterEvents,[a,b])},i=function(b){d(o.events.beforeResolveEvents,[a,b])},j=function(b){d(o.events.afterResolveEvents,[a,b])},l=function(b){d(o.events.beforeNewChildEvents,[a,b])},m=function(b,c){d(o.events.afterNewChildEvents,[a,b,c])},n=function(a){d(o.events.onError,[a])},o.events=p,o.registerEvent=c,o.onError=n,o.beforeRegister=f,o.afterRegister=h,o.beforeResolve=i,o.afterResolve=j,o.beforeNewChild=l,o.afterNewChild=m,o},d=function(a){var b={};if(i.notString(a.name))throw k.argumentException("The module name is required","name");if(i.notDefined(a.factory))throw k.argumentException("The module factory is required","factory");return b.name=a.name,b.dependencies=a.dependencies||void 0,b.factory=a.factory,b},m=function(a,b){var c=function(){var c;try{c=a()}catch(d){i.isFunction(b)&&b(d)}i.isFunction(b)&&b(null,c)};y?y.nextTick(c):setTimeout&&setTimeout(c,0)},n=function(a,b,d,e){b=b||{};var f,g;return f={parentContainer:a},e.beforeNewChild(f),g=new c(f),a.registerAsync&&g.useAsync(y),e.afterNewChild(f,g),g},o=function(a,b,c){if(c.beforeRegister(a),a.name===g.containerRegistration||a.name===g.parentContainerRegistration)throw k.argumentException("The name you are trying to register is reserved","moduleName",a.name);return b[a.name]=a,m(function(){c.afterRegister(a)}),a},p=function(a,b,c,d){var e,f;if(i.notString(a))throw k.argumentException("The moduleName must be a string. If you are trying to resolve an array, use resolveMany.","moduleName");if(c.beforeResolve(a),e=b[a],void 0!==e)return t(e,b,c,d);if(f=r(a,b,d))return s(f);throw k.notResolvableException(a)},q=function(a,b,c,d,e){var f,g,h,j,l;f=function(b){i.notString(a)?b(k.argumentException("The moduleName must be a string. If you are trying to resolve an array, use resolveManyAsync.","moduleName")):b(null,null)},g=function(b,d){d(null,c.beforeResolve(a))},h=function(e,f){var g;g=b[a],void 0!==g?u(g,b,c,d,f):f(null,null)},j=function(c,e){c?e(null,c):e(null,r(a,b,d))},l=function(b,d){b?(c.afterResolve(b),d(null,b)):d(k.notResolvableException(a))},y.waterfall([f,g,h,j,l],e)},r=function(c,d,e){return c===g.containerRegistration?d:c===g.parentContainerRegistration?e.context.getContainer():void 0!==e?e.resolve(c):b?b(c):window?a[c]:void 0},s=function(a,b){return m(function(){b.afterResolve(a)}),a},t=function(a,b,c,d){return i.isArray(a.dependencies)&&a.dependencies.length>0?v(a,b,c,d):i.isFunction(a.factory)&&0===a.factory.length?a.factory.call():a.factory},u=function(a,b,c,d,e){return i.isArray(a.dependencies)&&a.dependencies.length>0?void w(a,b,c,d,e):void(i.isFunction(a.factory)&&0===a.factory.length?e(null,a.factory.call()):e(null,a.factory))},v=function(a,b,c,d){var e,f=[],g=function(a){return p(a,b,c,d)};for(e=0;e<a.dependencies.length;e+=1)f.push(g(a.dependencies[e]));return a.factory.apply(null,f)},w=function(a,b,c,d,e){var f,g=[],h=function(a){return function(e){q(a,b,c,d,e)}};for(f=0;f<a.dependencies.length;f+=1)g.push(h(a.dependencies[f]));y.parallel(g,function(b,c){e(null,a.factory.apply(null,c))})},x=function(a,b){var c,d,e=[];if(i.isObject(a)&&(a.name||a.dependencies||a.factory))e.push(function(){b(a).call()});else if(i.isObject(a))for(c in a)a.hasOwnProperty(c)&&e.push(b(a[c]));else{if(!i.isArray(a))throw k.argumentException("A index must be defined and must be a typeof object or array","index");for(d=0;d<a.length;d+=1)e.push(b(a[d]))}return e},l=function(a,b,c,d,e){if(!(a&&a.nextTick&&a.waterfall&&a.parallel))throw k.argumentException("The async library is required (https://www.npmjs.com/package/async)","async");return y||(y=a),b.registerAsync=function(a,c){m(function(){return b.register(a)},c)},b.autoRegisterAsync=function(a,c){var d;d=function(a){return function(c){a.name?b.registerAsync(a,c):b.resolve(a,c)}},y.parallel(x(a,d),c)},b.resolveAsync=function(a,b){return q(a,c,d,e,b)},b.resolveManyAsync=function(a,f){var g,h=[],j={},l=function(a){return function(f){j[a]=b.resolve(a,c,d,e),f(null,null)}};if(i.notArray(a))throw k.argumentException("The moduleNameArray is required and must be an Array","moduleNameArray");if(i.notFunction(f))throw k.argumentException("The next argument is required and must be a Function","next");for(g=0;g<a.length;g+=1)h.push(l(a[g]));y.parallel(h,function(){f(null,j)})},b.disposeAsync=function(a,c){var d=c;i.isFunction(a)&&(d=a),m(function(){b.dispose(a)},d)},b.registerEventAsync=function(a,c,d){m(function(){return b.registerEvent(a,c)},d)},b},c=function(a){var b=this,c=a||{},e={},h=c.parentContainer,j=c.pipeline||new f(b,i),m={},r={};for(b.createChildContainer=function(a){n(b,a,c,j)},b.register=function(a){return o(new d(a),e,j),b},b.autoRegister=function(a,c){var d,e,f;d=function(a){return function(){a.name?b.register(a):b.resolve(a)}};try{for(e=x(a,d),f=0;f<e.length;f+=1)e[f]();i.isFunction(c)&&c(null)}catch(g){c(g)}},b.resolve=function(a){return p(a,e,j,h)},b.resolveMany=function(a,c){var d,e=[];if(i.notArray(a))throw k.argumentException("The moduleNameArray is required and must be an Array","moduleNameArray");if(i.notFunction(c))throw k.argumentException("The next argument is required and must be a Function","next");for(d=0;d<a.length;d+=1)e.push(b.resolve(a[d]));return c.apply(null,e)},b.autoResolve=function(a,c){var d,e,f,g={};d=function(a){return function(){g[a]=b.resolve(a)}};try{for(e=x(a,d),f=0;f<e.length;f+=1)e[f]();i.isFunction(c)&&c(null,g)}catch(h){c(h)}},b.dispose=function(a){var b,c;if(i.isString(a))delete e[a];else if(i.isArray(a))for(c=0;c<a.length;c+=1)delete e[a[c]];else for(b in e)e.hasOwnProperty(b)&&delete e[b]},b.registerEvent=function(a,b){return j.registerEvent(a,b)},b.useAsync=function(a){return l(a,b,e,j,h)},b.getContext=function(){return{container:e,parent:h,register:o,resolve:p,resolveAsync:q,constants:g,utils:i,exceptionHandlers:k}},m.count=0;m.count<z.length;m.count+=1)m.current=z[m.count],i.isFunction(m.current.factory)?b[m.current.name]=m.current.factory(b):i.isDefined(m.current.factory)&&(b[m.current.name]=m.current.factory);for(r.count=0;r.count<A.length;r.count+=1)r.current=A[r.count],i.isFunction(r.current)&&r.current(b,c)},c.extend=function(a,b){return z.push({name:a,factory:b}),!0},c.onInit=function(a){return A.push(a),!0},a.Hilary=c}("undefined"!=typeof module&&module.exports?module.exports:window,"undefined"!=typeof module&&module.exports?require:void 0);