/*! hilary-build 2015-07-31 */
!function(a,b){"use strict";if(a.Hilary)return!1;var c,d,e,f,g,h,i,j,k,l,m,n,o=[],p={},q=[];g={bootstrapperRegistration:"hilary::bootstrapper",containerRegistration:"hilary::container",parentContainerRegistration:"hilary::parent",blueprintRegistration:"hilary::Blueprint",notResolvable:"hilary::handler::not::resolvable",pipeline:{beforeRegister:"hilary::before::register",afterRegister:"hilary::after::register",beforeResolve:"hilary::before::resolve",afterResolve:"hilary::after::resolve",beforeNewChild:"hilary::before::new::child",afterNewChild:"hilary::after::new::child",onError:"hilary::error"}},h=function(){var a,b,c={getType:void 0,defined:void 0,nullOrUndefined:void 0,"function":void 0,object:void 0,array:void 0,string:void 0,bool:void 0,"boolean":void 0,datetime:void 0,regexp:void 0,number:void 0,nullOrWhitespace:void 0,money:void 0,decimal:void 0,Window:void 0,not:{defined:void 0,"function":void 0,object:void 0,array:void 0,string:void 0,bool:void 0,"boolean":void 0,datetime:void 0,regexp:void 0,number:void 0,nullOrWhitespace:void 0,money:void 0,decimal:void 0,Window:void 0}},d={},e=["Boolean","Number","String","Function","Array","Date","RegExp","Object"];for(a=0;a<e.length;a+=1)b=e[a],d["[object "+b+"]"]=b.toLowerCase();return c.getType=function(a){return"undefined"==typeof a?"undefined":null===a?String(a):"object"==typeof a||"function"==typeof a?d[Object.prototype.toString.call(a)]||"object":typeof a},c.defined=function(a){try{return"undefined"!==c.getType(a)}catch(b){return!1}},c.not.defined=function(a){return c.defined(a)===!1},c.nullOrUndefined=function(a){return c.not.defined(a)||null===a},c.not.nullOrWhitespace=function(a){return"undefined"==typeof a||null===typeof a||c.not.string(a)?!1:/([^\s])/.test(a)},c.nullOrWhitespace=function(a){return c.not.nullOrWhitespace(a)===!1},c["function"]=function(a){return"function"===c.getType(a)},c.not["function"]=function(a){return c["function"](a)===!1},c.object=function(a){return"object"===c.getType(a)},c.not.object=function(a){return c.object(a)===!1},c.array=function(a){return"array"===c.getType(a)},c.not.array=function(a){return c.array(a)===!1},c.string=function(a){return"string"===c.getType(a)},c.not.string=function(a){return c.string(a)===!1},c.bool=function(a){return"boolean"===c.getType(a)},c.not.bool=function(a){return c["boolean"](a)===!1},c["boolean"]=function(a){return"boolean"===c.getType(a)},c.not["boolean"]=function(a){return c["boolean"](a)===!1},c.datetime=function(a){return"date"===c.getType(a)},c.not.datetime=function(a){return c.datetime(a)===!1},c.regexp=function(a){return"regexp"===c.getType(a)},c.not.regexp=function(a){return c.regexp(a)===!1},c.number=function(a){return"number"===c.getType(a)},c.not.number=function(a){return c.number(a)===!1},c.money=function(a){return c.defined(a)&&/^(?:-)?[0-9]\d*(?:\.\d{0,2})?$/.test(a.toString())},c.not.money=function(a){return c.money(a)===!1},c.decimal=function(a,b){return c.not.number(a)?!1:!b&&c.number(a)?!0:a&&+(+a||0).toFixed(b)===+a?!0:!1},c.not.decimal=function(a){return c.decimal(a)===!1},c.Window=function(a){return c.is.defined(Window)&&a instanceof Window},c.not.Window=function(a){return c.is.Window(a)===!1},c}(),i=function(){var a,b={createUid:void 0,createGuid:void 0};return a=function(a){return a.replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},b.createUid=function(b){var c;return b=b||12,c=new Array(b+1).join("x"),a(c)},b.createGuid=function(){return a("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx")},b}(),j=function(a){var b={runAsync:void 0};return b.runAsync=function(b,c){c===!0&&a.defined(process)&&a["function"](process.nextTick)?process.nextTick(b):setTimeout(b,0)},b}(h),k=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p={errors:{blueprint:{requiresImplementation:"An implementation is required to create a new instance of an interface",requiresProperty:"The implementation is missing a required property",requiresArguments:"The implementation of this function requires arguments",missingConstructorArgument:"An object literal is required when constructing a Blueprint",reservedPropertyName_singatureMatches:"signatureMatches is a reserved property name for Blueprints",missingSignatureMatchesImplementationArgument:"A first argument of an object that should implement an interface is required",missingSignatureMatchesCallbackArgument:"A callback function is required as the second argument to signatureMatches"}}};return e=function(a,b,c){var d;a.__interfaces=a.__interfaces||{},d=function(d,e){d||(a.__interfaces[b.__blueprintId]=!0),"function"==typeof c&&c(d,e)},g(a,b,d)},f=function(a,b){var c;return a.__interfaces=a.__interfaces||{},c=h(a,b),c.result&&(a.__interfaces[b.__blueprintId]=!0),c},g=function(a,b,c){var d=h(a,b);d.result?c(null,!0):c(d.errors,!1)},h=function(a,b){var c,d=[];if(a.__interfaces[b.__blueprintId])return{errors:null,result:!0};for(c in b.props)b.props.hasOwnProperty(c)&&i(b.__blueprintId,a,c,b.props[c],d);return d.length>0?{errors:d,result:!1}:{errors:null,result:!0}},i=function(a,c,d,e,f){b.string(e)?k(a,c,d,e,f):b.object(e)&&j(a,c,d,e,e.type,f)},j=function(a,c,d,e,f,g){if(b["function"](e.validate))e.validate(c[d],g);else switch(f){case"function":k(a,c,d,f,g),e.args&&l(a,c,d,e.args,g);break;case"decimal":m(a,c,d,e.places,g);break;default:k(a,c,d,f,g)}},o=function(a,b,c,d){var e=a.concat(" @blueprint: ",b," @property: ",c," (",d,")");return e},k=function(a,c,d,e,f){b["function"](b.not[e])&&b.not[e](c[d])&&f.push(o(p.errors.blueprint.requiresProperty,a,d,e))},l=function(a,c,d,e,f){var g,h;if(g=b.array(e),g=g&&e.length>0,g=g&&b["function"](c[d]),g=g&&c[d].length===e.length,!g){try{h=e.join(", ")}catch(i){h=e.toString()}f.push(o(p.errors.blueprint.requiresArguments,a,d,h))}},m=function(a,c,d,e,f){b.not.decimal(c[d],e)&&f.push(o(p.errors.blueprint.requiresProperty,a,d,"decimal with "+e+" places"))},n=function(a,c,d,e){b["function"](b.not["boolean"])&&b.not["boolean"](c[d])&&e.push(o(p.errors.blueprint.requiresProperty,a,d,"boolean"))},d=function(d){var g,h=this;d=d||{},h.props={};for(g in d)d.hasOwnProperty(g)&&("__blueprintId"===g?h.__blueprintId=d.__blueprintId:h.props[g]=d[g]);b.not.string(h.__blueprintId)&&(h.__blueprintId=c.createUid(8)),h.signatureMatches=function(c,d){if(b.not.defined(c))return void d([p.errors.blueprint.missingSignatureMatchesImplementationArgument]);if(b.not["function"](d))throw new Error(p.errors.blueprint.missingSignatureMatchesCallbackArgument);a.runAsync(function(){e(c,h,d)})},h.syncSignatureMatches=function(a){return b.not.defined(a)?{errors:[p.errors.blueprint.missingSignatureMatchesImplementationArgument],result:!1}:f(a,h)},h.inherits=function(a){for(g in a.props)a.props.hasOwnProperty(g)&&(h.props[g]=a.props[g])}}}(j,h,i),l=function(a,b){var c,d={};return c=function(c,d,e){var f=a.string(d)?d:c,g=new Error(f);return g.message=f,c!==f&&(g.name=c),e&&(g.data=e),b.onError(g),g},d.makeException=c,d.argumentException=function(b,d,e){var f=a.not.defined(d)?b:b+" (argument: "+d+")";return c("ArgumentException",f,e)},d.dependencyException=function(b,d,e){var f=a.not.defined(d)?b:b+" (dependency: "+d+"). If the module exists, does it return a value?";return c("DependencyException",f,e)},d.notImplementedException=function(a,b){return c("NotImplementedException",a,b)},d.notResolvableException=function(a){return d.dependencyException("The module cannot be resolved",a)},d},m=function(a){return function(b){var c,d,e,f;b=b||{},e=function(a,b){a.getContext().pipeline.onError(b)},d=function(a){h["function"](b.composeLifecycle)&&4===b.composeLifecycle.length?b.composeLifecycle(null,a,a.getContext().pipeline,c):h["function"](b.composeLifecycle)?(b.composeLifecycle(null,a,a.getContext().pipeline),c(null,a)):c(null,a)},c=function(a,d){a&&e(d,a);try{d.register({name:g.bootstrapperRegistration,factory:function(){return{restart:function(){c(d)}}}})}catch(i){a=i}h["function"](b.composeModules)&&3===b.composeModules.length?b.composeModules(a,d,f):h["function"](b.composeModules)?(b.composeModules(a,d),f(a,d)):f(a,d)},f=function(a,c){h["function"](b.onComposed)&&b.onComposed(a,c)},d(a)}},e=function(){var a={};return a.beforeRegisterEvents=[],a.afterRegisterEvents=[],a.beforeResolveEvents=[],a.afterResolveEvents=[],a.beforeNewChildEvents=[],a.afterNewChildEvents=[],a.onError=[],a},f=function(a,b){var c,d,f,h,i,j,k,l,m,n={},o=new e;return c=function(b,c){switch(b){case g.pipeline.beforeRegister:return o.beforeRegisterEvents.push(c),a;case g.pipeline.afterRegister:return o.afterRegisterEvents.push(c),a;case g.pipeline.beforeResolve:return o.beforeResolveEvents.push(c),a;case g.pipeline.afterResolve:return o.afterResolveEvents.push(c),a;case g.pipeline.beforeNewChild:return o.beforeNewChildEvents.push(c),a;case g.pipeline.afterNewChild:return o.afterNewChildEvents.push(c),a;case g.pipeline.onError:return o.onError.push(c),a;default:throw new Error("the pipeline event you are trying to register is not implemented (name: "+b+")")}},d=function(a,c){var d,e;for(d=0;d<a.length;d+=1)e=a[d],e.once&&a.splice(d,1),b["function"](e)&&e.apply(null,c)},f=function(b){d(n.events.beforeRegisterEvents,[a,b])},h=function(b){d(n.events.afterRegisterEvents,[a,b])},i=function(b){d(n.events.beforeResolveEvents,[a,b])},j=function(b){d(n.events.afterResolveEvents,[a,b])},k=function(b){d(n.events.beforeNewChildEvents,[a,b])},l=function(b,c){d(n.events.afterNewChildEvents,[a,b,c])},m=function(a){d(n.events.onError,[a])},n.events=o,n.registerEvent=c,n.onError=m,n.beforeRegister=f,n.afterRegister=h,n.beforeResolve=i,n.afterResolve=j,n.beforeNewChild=k,n.afterNewChild=l,n},d=function(d,e){return function(f,h,i,j,k,l){var m,o,p,q,r,s={},t=[],u=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,v=/([^\s,]+)/g;return s.HilaryModule=function(a){var b=this;if(d.not.string(a.name))throw l.argumentException("The module name is required","name");if(d.not.defined(a.factory))throw l.argumentException("The module factory is required","factory");b.name=a.name,b.dependencies=a.dependencies||void 0,b.factory=a.factory,b.blueprint=a.blueprint,b.singleton=a.singleton},s.asyncHandler=function(a,b){var c=function(){var c;try{c=a()}catch(e){return void(d["function"](b)&&b(e))}d["function"](b)&&b(null,c)};n?n.nextTick(c):e.runAsync(c)},s.createChildContainer=function(a,b){b=b||{};var d;return b.parentContainer=a,j.beforeNewChild(b),d=new c(b),a.registerAsync&&d.useAsync(n),j.afterNewChild(b,d),d},m=function(a){return a.dependencies||"function"!=typeof a.factory?a:(a.dependencies=q(a.factory),a)},q=function(a){if(!a)return[];var b=a.toString().replace(u,""),c=b.slice(b.indexOf("(")+1,b.indexOf(")")).match(v);return null===c&&(c=[]),c},o=function(a,b){return function(){var c=f.resolve(a),e=f.resolve(b),g=d.not["function"](c.signatureMatches),h="Blueprints must have a signatureMatches function";return g?{errors:[h],result:!1}:c.syncSignatureMatches(e)}},p=function(a){if(d.string(a.blueprint))t.push({blueprintName:a.blueprint,moduleName:a.name});else if(d.array(a.blueprint)){var b;for(b=0;b<a.blueprint.length;b+=1)t.push({blueprintName:a.blueprint[b],moduleName:a.name})}},r=function(a,b){var c=function(a,b){i[a]=b};b?c(a.name,b):(d.object(a.factory)||d["function"](a.factory)&&a.factory.length>0&&(d.not.defined(a.dependencies)||a.dependencies.length<1))&&c(a.name,a.factory)},s.register=function(a){if(j.beforeRegister(a),a.name===g.containerRegistration||a.name===g.parentContainerRegistration)throw l.argumentException("The name you are trying to register is reserved","moduleName",a.name);return a=m(a),h[a.name]=a,r(a),d.defined(a.blueprint)&&p(a),s.asyncHandler(function(){j.afterRegister(a)}),a},s.resolve=function(a){var b;if(d.not.string(a))throw l.argumentException("The moduleName must be a string. If you are trying to resolve an array, use resolveMany.","moduleName");if(j.beforeResolve(a),void 0!==i[a])return s.returnResult({name:a,result:i[a]},j);if(void 0!==h[a])return b=s.invoke(h[a]),h[a].singleton===!0&&r(h[a],b),s.returnResult({name:a,result:b},j);if(b=s.findResult(a))return s.returnResult({name:a,result:b},j);throw l.notResolvableException(a)},s.resolveMany=function(a,b){var c,e,g=[];if(d.not.array(a))throw l.argumentException("The moduleNameArray is required and must be an Array","moduleNameArray");if(d.not["function"](b))throw l.argumentException("The next argument is required and must be a Function","next");for(c=0;c<a.length;c+=1)try{e=f.resolve(a[c]),g.push(e)}catch(h){g.push(h)}return b.apply(null,g)},s.resolveManyAsync=function(a,b){var c,e=[],g={},h=function(a){return function(b){try{g[a]=f.resolve(a),b(null,null)}catch(c){b(c)}}};if(d.not.array(a))throw l.argumentException("The moduleNameArray is required and must be an Array","moduleNameArray");if(d.not["function"](b))throw l.argumentException("The next argument is required and must be a Function","next");for(c=0;c<a.length;c+=1)e.push(h(a[c]));n.parallel(e,function(a){b(a,g)})},s.resolveAsync=function(a,b){var c,e,f,g,k;c=function(b){d.not.string(a)?b(l.argumentException("The moduleName must be a string. If you are trying to resolve an array, use resolveManyAsync.","moduleName")):b(null,null)},e=function(b,c){c(null,j.beforeResolve(a))},f=function(b,c){void 0!==i[a]?c(null,i[a]):void 0!==h[a]?s.invokeAsync(h[a],c):c(null,null)},g=function(b,c){b?c(null,b):c(null,s.findResult(a))},k=function(b,c){b?(j.afterResolve({name:a,result:b}),c(null,b)):c(l.notResolvableException(a))},n.waterfall([c,e,f,g,k],b)},s.findResult=function(d){if(d===g.containerRegistration)return h;if(d===g.parentContainerRegistration)return k.getContext().container;if(d===g.blueprintRegistration)return c.Blueprint;if(void 0!==k)return k.resolve(d);if(b)try{return b(d)}catch(e){return null}else if(window)return a[d]},s.returnResult=function(a){return s.asyncHandler(function(){j.afterResolve(a)}),a.result},s.invoke=function(a){return d.array(a.dependencies)&&a.dependencies.length>0?s.applyDependencies(a):d["function"](a.factory)&&0===a.factory.length?a.factory.call():a.factory},s.invokeAsync=function(a,b){var c;return d.array(a.dependencies)&&a.dependencies.length>0?void s.applyDependenciesAsync(a,b):(c=d["function"](a.factory)&&0===a.factory.length?a.factory.call():a.factory,a.singleton===!0&&r(a,c),void b(null,c))},s.applyDependencies=function(a){var b,c=[],d=function(a){return s.resolve(a)};for(b=0;b<a.dependencies.length;b+=1)c.push(d(a.dependencies[b]));return a.factory.apply(null,c)},s.applyDependenciesAsync=function(a,b){var c,d=[],e=function(a){return function(b){s.resolveAsync(a,b)}};for(c=0;c<a.dependencies.length;c+=1)d.push(e(a.dependencies[c]));n.parallel(d,function(c,d){var e=a.factory.apply(null,d);a.singleton===!0&&r(a,e),b(null,e)})},s.makeAutoRegistrationTasks=function(a,b){var c,e,f=[];if(d.object(a)&&(a.name||a.dependencies||a.factory))f.push(function(){b(a).call()});else if(d.object(a))for(c in a)a.hasOwnProperty(c)&&f.push(b(a[c]));else{if(!d.array(a))throw l.argumentException("A index must be defined and must be a typeof object or array","index");for(e=0;e<a.length;e+=1)f.push(b(a[e]))}return f},s.autoRegister=function(a,b){var c,e,f;c=function(a){return function(){s.register(a)}};try{for(e=s.makeAutoRegistrationTasks(a,c),f=0;f<e.length;f+=1)e[f]();d["function"](b)&&b(null)}catch(g){b(g)}},s.autoResolve=function(a,b){var c,e,g;c=function(a){return function(){d.array(a.dependencies)&&d["function"](a.factory)?f.resolveMany(a.dependencies,a.factory):d["function"](a.factory)&&0===a.factory.length&&a.factory()}};try{for(e=s.makeAutoRegistrationTasks(a,c),g=0;g<e.length;g+=1)e[g]();d["function"](b)&&b(null,null)}catch(h){b(h)}},s.autoResolveAsync=function(a,b){var c;c=function(a){return function(b){d.array(a.dependencies)&&d["function"](a.factory)?(f.resolveManyAsync(a.dependencies,a.factory),b(null,null)):d["function"](a.factory)&&0===a.factory.length?(a.factory(),b(null,null)):b(l.argumentException("One or more of the items in this index do not meet the requirements for resolution.","index",a))}},n.parallel(s.makeAutoRegistrationTasks(a,c),b)},s.dispose=function(a){var b,c,e;if(d.string(a))return s.disposeOne(a);if(d.array(a)){for(e=!0,c=0;c<a.length;c+=1)e=e&&s.disposeOne(a[c]);return e}if(a)return!1;e=!0;for(b in h)h.hasOwnProperty(b)&&(e=e&&s.disposeOne(b));return t=[],e},s.disposeOne=function(a){return h[a]?(delete h[a],!0):!1},s.validateBlueprints=function(){var a,b,c=[],d=[],e=!0;for(b=0;b<t.length;b+=1)c.push(o(t[b].blueprintName,t[b].moduleName));for(b=0;b<c.length;b+=1)a=c[b](),a.result===!1&&(d=d.concat(a.errors),e=!1);return e?{errors:null,result:!0}:{errors:d,result:!1}},s.validateBlueprintsAsync=function(a){var b,c,d=[];for(b=function(a){return function(b){var c=o(t[a].blueprintName,t[a].moduleName)();b(c.errors,c.result)}},c=0;c<t.length;c+=1)d.push(b(c));n.parallel(d,a)},s.useAsync=function(a){if(!(a&&a.nextTick&&a.waterfall&&a.parallel))throw l.argumentException("The async library is required (https://www.npmjs.com/package/async)","async");return n||(n=a),f.registerAsync=function(a,b){return s.asyncHandler(function(){return f.register(a)},b),f},f.autoRegisterAsync=function(a,b){var c;return c=function(a){return function(b){f.registerAsync(a,b)}},n.parallel(s.makeAutoRegistrationTasks(a,c),b),f},f.resolveAsync=function(a,b){return s.resolveAsync(a,b),f},f.resolveManyAsync=function(a,b){return s.resolveManyAsync(a,b),f},f.autoResolveAsync=function(a,b){return s.autoResolveAsync(a,b),f},f.disposeAsync=function(a,b){var c=b,e=a;return d["function"](a)&&(c=a,e=null),s.asyncHandler(function(){return f.dispose(e)},c),f},f.validateBlueprintsAsync=function(a){return s.validateBlueprintsAsync(a),f},f.registerEventAsync=function(a,b,c){return s.asyncHandler(function(){return f.registerEvent(a,b)},c),f},f},s}}(h,j),c=function(a){var b=this,c=a||{},e={},j={},k=c.parentContainer,n=c.pipeline||new f(b,h),r=new l(h,n),s={},t={},u=new d(b,e,j,n,k,r);for(b.createChildContainer=function(a){var c;return c=h.string(a)?{name:a}:h.object(a)?a:{},u.createChildContainer(b,c)},b.setParentContainer=function(a){"function"==typeof a.register&&"function"==typeof a.resolve&&(k=a,u=new d(b,e,j,n,k,r))},b.register=function(a){return u.register(new u.HilaryModule(a)),b},b.autoRegister=function(a,c){return u.autoRegister(a,c),b},b.resolve=function(a){return u.resolve(a)},b.resolveMany=function(a,b){return u.resolveMany(a,b)},b.autoResolve=function(a,c){return u.autoResolve(a,c),b},b.dispose=function(a){return u.dispose(a)},b.registerEvent=function(a,c){return n.registerEvent(a,c),b},b.validateBlueprints=function(){return u.validateBlueprints()},b.useAsync=function(a){return u.useAsync(a),b},b.Bootstrapper=new m(b),b.getContext=function(){return{container:e,singletons:j,parent:k,pipeline:n,HilaryModule:u.HilaryModule,register:u.register,constants:g,is:h,id:i,exceptionHandlers:r}},s.count=0;s.count<o.length;s.count+=1)s.current=o[s.count],h["function"](s.current.factory)?b[s.current.name]=s.current.factory(b):h.defined(s.current.factory)&&(b[s.current.name]=s.current.factory);for(t.count=0;t.count<q.length;t.count+=1)t.current=q[t.count],h["function"](t.current)&&t.current(b,c);c.name&&(p[c.name]=b)},c.extend=function(a,b){return o.push({name:a,factory:b}),!0},c.onInit=function(a){return q.push(a),!0},c.scope=function(a,b){return p[a]?p[a]:(p[a]=new c(b),p[a])},c.Blueprint=k,a.Hilary=c}("undefined"!=typeof module&&module.exports?module.exports:window,"undefined"!=typeof module&&module.exports?require:void 0);